@model Musique.Models.Cart

@{
	ViewBag.Title = "Shopping Cart";
}

<h2>My Shopping Cart</h2>

<div id="deleted">
</div>

<table class="table">
	<tr>
		<th>
			Title
		</th>
		<th>
			Artist
		</th>
		<th>
			Album
		</th>
		<th>
			ReleaseDate
		</th>
		<th>
			Genre
		</th>
		<th>
			Formats
		</th>
		<th>
			Price
		</th>
		<th></th>
	</tr>

	@foreach (var item in Model.CartMusics)
	{
		<tr id="@item.ID">
			<td>
				@Html.DisplayFor(modelItem => item.Title)
			</td>
			<td>
				@Html.DisplayFor(modelItem => item.Artist)
			</td>
			<td>
				@Html.DisplayFor(modelItem => item.Album)
			</td>
			<td>
				@Html.DisplayFor(modelItem => item.ReleaseDate)
			</td>
			<td>
				@Html.DisplayFor(modelItem => item.Genre)
			</td>
			<td>
				@Html.DisplayFor(modelItem => item.Formats)
			</td>
			<td>
				@Html.DisplayFor(modelItem => item.Price)
			</td>
			<td>
				@Html.ActionLink("Details", "Details", "Musics", new { id = item.ID }, null) |
				<a href="#" data-toggle="modal" data-target="#modalremove@(item.ID)">Remove From Cart</a>
				<div id="modalremove@(item.ID)" class="modal fade" role="dialog">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal">&times;</button>
								<h4 class="modal-title">Are you sure you want to remove this track from your cart ?</h4>
							</div>
							<div class="modal-body">
								<dl class="dl-horizontal">
									<dt>@Html.DisplayNameFor(model => item.Title)</dt>

									<dd>@Html.DisplayFor(model => item.Title)</dd>

									<dt>@Html.DisplayNameFor(model => item.Artist)</dt>

									<dd>@Html.DisplayFor(model => item.Artist)</dd>

									<dt>@Html.DisplayNameFor(model => item.Price)</dt>

									<dd>@Html.DisplayFor(model => item.Price)</dd>

								</dl>
							</div>
							<div class="modal-footer">
								<button type="button" class="delete btn btn-danger" value="@item.ID">Remove From Cart</button>
								<button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
							</div>
						</div>
					</div>
				</div>
			</td>
		</tr>
	}
</table>

<script type="text/javascript" defer>
	$(document).ready(function () {
		$('button.delete').on('click', function () {
			var musicID2 = $(this).val();
			$.ajax({
				method: "POST",
				url: "/Cart/Delete",
				data: { musicID2: musicID2 }
			}).done(function (response) {
				$('#deleted').html(response);
				$('#modalremove' + musicID2).modal('hide');
				$('#' + musicID2).addClass('hidden');
			});
		});
	});
</script>